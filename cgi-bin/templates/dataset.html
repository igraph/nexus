$def with (ds, tags, formats, papers)

$code:
    def tag_link(tag, caption=None):
        if caption is None:
            caption = tag.tag
        caption = websafe(caption)
        tag = websafe(tag.tag)
        return '<a href="/html/tagged/%s">%s</a>' % (tag, caption)

$if openid.status():
  <div class="feed">
    <form method="get" action="/edit/$ds.id">
      <button type="submit" style="margin-left:20px;">
        <h2>Edit</h2>
      </button>
    </form>
  </div>

<div class="title"><h2>$ds.name</h2></div>

<div class="dataset">
<p class="datasettags2">
  $ds.vertices vertices, $ds.edges edges.
  Tags:
  $:", ".join(link_to_tag(tag) for tag in tags)
<p class="datasetdate2">$ds.date</p>

<h3>Download</h3>
<p>
$for k,f in dataformats.items():
  <a href="/${k}/getdata/$ds.id/1">${k} format</a> &ndash; 
  $formats[k].shortdesc,
  <a href="/html/format/$k">more...</a>
</p>

<h3>Description</h3>
<p>$ds.description</p>

<h3>Publication(s)</h3>
$for p in papers:
  <p>$p.citation</p>


<h3>Licence</h3>
<p>$ds.licence_name</p>

</div>
